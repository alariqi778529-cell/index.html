<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø§Ø­ØªÙ†Ø§</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; margin: 0; height: 100vh; display: flex; flex-direction: column; }
        #lock { position: fixed; inset: 0; background: white; z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: black; }
        .header { background: #ff4b2b; padding: 15px; text-align: center; font-weight: bold; }
        #chat { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .msg { padding: 10px; border-radius: 15px; max-width: 80%; word-wrap: break-word; }
        .sent { align-self: flex-end; background: #ff4b2b; }
        .rcvd { align-self: flex-start; background: #333; }
        .input-area { padding: 15px; background: #1e1e1e; display: flex; gap: 8px; border-top: 1px solid #333; }
        input { flex: 1; padding: 12px; border-radius: 25px; border: none; background: #333; color: white; outline: none; }
        .btn { background: #ff4b2b; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; }
    </style>
</head>
<body>

<div id="lock">
    <h2>ğŸ”’ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ</h2>
    <input type="password" id="pass" placeholder="7777" style="border: 2px solid #ff4b2b; margin-bottom: 15px;">
    <button class="btn" onclick="unlock()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div class="header">â¤ï¸ Ù…Ø³Ø§Ø­ØªÙ†Ø§ Ø§Ù„Ø®Ø§ØµØ© â¤ï¸</div>
<div id="chat">
    <div class="msg rcvd">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø±...</div>
</div>

<div class="input-area" id="setup">
    <input type="text" id="room" placeholder="Ø§Ø³Ù… Ø§Ù„ØºØ±ÙØ© (Ù…Ø«Ù„Ø§Ù‹: love)">
    <button class="btn" onclick="start()">Ø±Ø¨Ø·</button>
</div>

<div class="input-area" id="mainChat" style="display:none">
    <input type="text" id="text" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
    <button class="btn" onclick="send()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>

<script>
    let p, c;
    function unlock() { if(document.getElementById('pass').value === "7777") document.getElementById('lock').style.display='none'; }

    function start() {
        const r = "room-" + document.getElementById('room').value;
        if(!document.getElementById('room').value) return;
        
        p = new Peer(r);
        p.on('open', () => { showChat("ØªÙ… ÙØªØ­ Ø§Ù„ØºØ±ÙØ©ØŒ Ø§Ø·Ù„Ø¨ Ù…Ù†Ù‡Ø§ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†ÙØ³ Ø§Ù„Ø§Ø³Ù…"); });
        p.on('connection', conn => { c = conn; listen(); });
        p.on('error', (err) => {
            if(err.type === 'id-taken') {
                p = new Peer();
                p.on('open', () => {
                    c = p.connect(r);
                    listen();
                });
            }
        });
    }

    function listen() {
        c.on('open', () => { 
            showChat("âœ… Ù…ØªØµÙ„Ø§Ù† Ø§Ù„Ø¢Ù†! Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø±Ø§Ø³Ù„Ø©");
            document.getElementById('setup').style.display='none';
            document.getElementById('mainChat').style.display='flex';
        });
        c.on('data', data => addMsg(data, 'rcvd'));
    }

    function send() {
        const m = document.getElementById('text').value;
        if(c && m) { c.send(m); addMsg(m, 'sent'); document.getElementById('text').value=''; }
    }

    function addMsg(t, s) {
        const d = document.createElement('div');
        d.className = 'msg ' + s; d.innerText = t;
        document.getElementById('chat').appendChild(d);
        document.getElementById('chat').scrollTop = document.getElementById('chat').scrollHeight;
    }

    function showChat(t) { addMsg(t, 'rcvd'); }
</script>
</body>
</html>
